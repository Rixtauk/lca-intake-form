<!DOCTYPE html>
<html lang="en">
  <head>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <title>LCA-CALC Intake Form</title>
    <script src="https://cdn.tailwindcss.com"></script>
    <link rel="preconnect" href="https://fonts.googleapis.com" />
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin />
    <link href="https://fonts.googleapis.com/css2?family=Inter:wght@400;500;600;700&display=swap" rel="stylesheet" />
    <style>
      body {
        font-family: 'Inter', system-ui, -apple-system, BlinkMacSystemFont, 'Segoe UI', sans-serif;
        background: linear-gradient(135deg, #f8fafc 0%, #e2e8f0 100%);
      }
      .gradient-header {
        background: linear-gradient(to right, #34ee63, #2acc56);
      }
    </style>
  </head>
  <body class="min-h-screen">
    <div id="root"></div>

    <script src="https://unpkg.com/react@18/umd/react.production.min.js" crossorigin></script>
    <script src="https://unpkg.com/react-dom@18/umd/react-dom.production.min.js" crossorigin></script>
    <script src="https://unpkg.com/@babel/standalone/babel.min.js"></script>
    <script src="https://cdn.jsdelivr.net/npm/@supabase/supabase-js@2"></script>

    <script type="text/babel">
      const { useState, useEffect } = React;

      // Initialize Supabase client
      const supabase = supabase.createClient(
        'https://hihtcrunhtddiebilors.supabase.co',
        'eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJpc3MiOiJzdXBhYmFzZSIsInJlZiI6ImhpaHRjcnVuaHRkZGllYmlsb3JzIiwicm9sZSI6ImFub24iLCJpYXQiOjE3NDcyOTg0NDIsImV4cCI6MjA2Mjg3NDQ0Mn0.4xw_nBavSK5iUTH73dSO-TlE1Boke6EukXK9hdr3SEk'
      );

      const iconBase = {
        viewBox: '0 0 24 24',
        fill: 'none',
        stroke: 'currentColor',
        strokeWidth: '2',
        strokeLinecap: 'round',
        strokeLinejoin: 'round'
      };

      const AlertCircle = ({ className }) => (
        <svg {...iconBase} className={className}>
          <circle cx="12" cy="12" r="10" />
          <line x1="12" y1="8" x2="12" y2="12" />
          <line x1="12" y1="16" x2="12.01" y2="16" />
        </svg>
      );

      const CheckCircle2 = ({ className }) => (
        <svg {...iconBase} className={className}>
          <path d="M9 12l2 2 4-4" />
          <circle cx="12" cy="12" r="10" />
        </svg>
      );

      const Loader2 = ({ className }) => (
        <svg {...iconBase} className={className}>
          <path d="M21 12a9 9 0 10-9 9" />
        </svg>
      );

      const ChevronRight = ({ className }) => (
        <svg {...iconBase} className={className}>
          <polyline points="9 18 15 12 9 6" />
        </svg>
      );

      const ChevronLeft = ({ className }) => (
        <svg {...iconBase} className={className}>
          <polyline points="15 18 9 12 15 6" />
        </svg>
      );

      const Save = ({ className }) => (
        <svg {...iconBase} className={className}>
          <path d="M19 21H5a2 2 0 0 1-2-2V5a2 2 0 0 1 2-2h11l5 5v11a2 2 0 0 1-2 2z" />
          <polyline points="17 21 17 13 7 13 7 21" />
          <polyline points="7 3 7 8 15 8" />
        </svg>
      );

      function LCACalcForm() {
        const [currentPage, setCurrentPage] = useState(1);
        const totalPages = 6;

        const [formData, setFormData] = useState({
          email: '',
          seats: '',
          lcasEpds: '',
          languages: '',
          materialsList: '',
          tm65CallTime: '',
          bomStorage: '',
          bomProcess: '',
          skuProcess: '',
          sapSystem: '',
          trainingFunctions: '',
          additionalComments: ''
        });

        const [submitStatus, setSubmitStatus] = useState({ type: '', message: '' });
        const [isSubmitting, setIsSubmitting] = useState(false);
        const [isComplete, setIsComplete] = useState(false);
        const [isSaving, setIsSaving] = useState(false);
        const [saveStatus, setSaveStatus] = useState({ type: '', message: '' });
        const [existingResponseId, setExistingResponseId] = useState(null);

        const handleChange = (event) => {
          const { name, value } = event.target;
          setFormData((prev) => ({
            ...prev,
            [name]: value
          }));
        };

        // Load saved responses when email is entered
        useEffect(() => {
          const loadSavedResponses = async () => {
            if (!formData.email || !formData.email.includes('@')) return;

            try {
              const { data, error } = await supabase
                .from('intake_form_responses')
                .select('*')
                .eq('email', formData.email)
                .order('updated_at', { ascending: false })
                .limit(1)
                .single();

              if (error && error.code !== 'PGRST116') {
                console.error('Error loading saved responses:', error);
                return;
              }

              if (data) {
                setExistingResponseId(data.id);
                setFormData({
                  email: data.email,
                  seats: data.seats || '',
                  lcasEpds: data.lcas_epds || '',
                  languages: data.languages || '',
                  materialsList: data.materials_list || '',
                  tm65CallTime: data.tm65_call_time || '',
                  bomStorage: data.bom_storage || '',
                  bomProcess: data.bom_process || '',
                  skuProcess: data.sku_process || '',
                  sapSystem: data.sap_system || '',
                  trainingFunctions: data.training_functions || '',
                  additionalComments: data.additional_comments || ''
                });
                setSaveStatus({
                  type: 'success',
                  message: 'Previous responses loaded successfully!'
                });
                setTimeout(() => setSaveStatus({ type: '', message: '' }), 3000);
              }
            } catch (err) {
              console.error('Error loading saved responses:', err);
            }
          };

          const timeoutId = setTimeout(loadSavedResponses, 500);
          return () => clearTimeout(timeoutId);
        }, [formData.email]);

        // Save progress to Supabase
        const handleSave = async () => {
          if (!formData.email || !formData.email.includes('@')) {
            setSaveStatus({
              type: 'error',
              message: 'Please enter a valid email address to save your progress.'
            });
            return;
          }

          setIsSaving(true);
          setSaveStatus({ type: '', message: '' });

          try {
            const payload = {
              email: formData.email,
              seats: formData.seats,
              lcas_epds: formData.lcasEpds,
              languages: formData.languages,
              materials_list: formData.materialsList,
              tm65_call_time: formData.tm65CallTime,
              bom_storage: formData.bomStorage,
              bom_process: formData.bomProcess,
              sku_process: formData.skuProcess,
              sap_system: formData.sapSystem,
              training_functions: formData.trainingFunctions,
              additional_comments: formData.additionalComments,
              updated_at: new Date().toISOString()
            };

            let result;
            if (existingResponseId) {
              // Update existing record
              result = await supabase
                .from('intake_form_responses')
                .update(payload)
                .eq('id', existingResponseId)
                .select()
                .single();
            } else {
              // Insert new record
              result = await supabase
                .from('intake_form_responses')
                .insert([payload])
                .select()
                .single();

              if (result.data) {
                setExistingResponseId(result.data.id);
              }
            }

            if (result.error) {
              throw result.error;
            }

            setSaveStatus({
              type: 'success',
              message: 'Your progress has been saved successfully!'
            });
            setTimeout(() => setSaveStatus({ type: '', message: '' }), 3000);
          } catch (error) {
            console.error('Error saving:', error);
            setSaveStatus({
              type: 'error',
              message: `Error saving: ${error.message}. Please try again.`
            });
          } finally {
            setIsSaving(false);
          }
        };

        const handleSubmit = async () => {
          const emptyFields = Object.entries(formData).filter(([_, value]) => !value.trim());
          if (emptyFields.length > 0) {
            setSubmitStatus({
              type: 'error',
              message: 'Please fill in all fields before submitting.'
            });
            return;
          }

          setIsSubmitting(true);
          setSubmitStatus({ type: '', message: '' });

          try {
            // First, save to Supabase
            const supabasePayload = {
              email: formData.email,
              seats: formData.seats,
              lcas_epds: formData.lcasEpds,
              languages: formData.languages,
              materials_list: formData.materialsList,
              tm65_call_time: formData.tm65CallTime,
              bom_storage: formData.bomStorage,
              bom_process: formData.bomProcess,
              sku_process: formData.skuProcess,
              sap_system: formData.sapSystem,
              training_functions: formData.trainingFunctions,
              additional_comments: formData.additionalComments,
              updated_at: new Date().toISOString()
            };

            let supabaseResult;
            if (existingResponseId) {
              // Update existing record
              supabaseResult = await supabase
                .from('intake_form_responses')
                .update(supabasePayload)
                .eq('id', existingResponseId)
                .select()
                .single();
            } else {
              // Insert new record
              supabaseResult = await supabase
                .from('intake_form_responses')
                .insert([supabasePayload])
                .select()
                .single();
            }

            if (supabaseResult.error) {
              console.error('Error saving to Supabase:', supabaseResult.error);
              // Continue with webhook submission even if Supabase fails
            } else {
              console.log('Successfully saved to Supabase');
            }

            // Then, submit to Make.com webhook
            const payload = {
              '1': formData.seats,
              '2': formData.lcasEpds,
              '3': formData.languages,
              '4': formData.materialsList,
              '5': formData.tm65CallTime,
              '6a': formData.bomStorage,
              '6b': formData.bomProcess,
              '6c': formData.skuProcess,
              '7': formData.sapSystem,
              '9': formData.trainingFunctions,
              '10': formData.additionalComments
            };

            console.log('Submitting payload to webhook', payload);

            const response = await fetch('https://hook.eu2.make.com/ns86en2yoic2stutc3n71l6weyf66w2s', {
              method: 'POST',
              headers: {
                'Content-Type': 'application/json'
              },
              body: JSON.stringify(payload)
            });

            if (response.ok || response.status === 200) {
              setFormData({
                email: '',
                seats: '',
                lcasEpds: '',
                languages: '',
                materialsList: '',
                tm65CallTime: '',
                bomStorage: '',
                bomProcess: '',
                skuProcess: '',
                sapSystem: '',
                trainingFunctions: '',
                additionalComments: ''
              });
              setExistingResponseId(null);
              setSubmitStatus({
                type: 'success',
                message: 'Thank you! Your responses have been received successfully.'
              });
              setIsComplete(true);
            } else {
              const errorText = await response.text();
              throw new Error(`Submission failed with status ${response.status}: ${errorText}`);
            }
          } catch (error) {
            setSubmitStatus({
              type: 'error',
              message: `Error: ${error.message}. Please try again later.`
            });
          } finally {
            setIsSubmitting(false);
          }
        };

        const nextPage = () => {
          if (currentPage < totalPages) {
            setCurrentPage((prev) => prev + 1);
            window.scrollTo({ top: 0, behavior: 'smooth' });
          }
        };

        const prevPage = () => {
          if (currentPage > 1) {
            setCurrentPage((prev) => prev - 1);
            window.scrollTo({ top: 0, behavior: 'smooth' });
          }
        };

        const inputClass = 'w-full px-4 py-3 border border-gray-300 rounded-lg transition focus:outline-none focus:ring-2 focus:ring-offset-2 focus:ring-green-300';
        const progressPercentage = (currentPage / totalPages) * 100;

        if (isComplete) {
          return (
            <div className="min-h-screen py-12 px-4">
              <div className="max-w-3xl mx-auto">
                <div className="bg-white rounded-lg shadow-xl overflow-hidden text-center">
                  <div className="gradient-header px-8 py-12 text-white">
                    <div className="flex justify-center mb-6">
                      <span className="bg-white rounded-full p-4 inline-flex">
                        <CheckCircle2 className="w-12 h-12 text-green-500" />
                      </span>
                    </div>
                    <h1 className="text-3xl font-semibold">Thank you for completing the intake</h1>
                    <p className="text-white/80 mt-2">Our team will be in touch shortly with next steps.</p>
                  </div>
                  <div className="px-8 py-12 space-y-6 text-gray-700">
                    <p className="text-lg">We appreciate the time you took to share the details we need to tailor your LCA-CALC solution.</p>
                    <div className="space-y-2">
                      <p>Next you can expect us to:</p>
                      <ul className="space-y-1">
                        <li>• Review your responses in detail</li>
                        <li>• Send over the TM65 &amp; TM66 session invite at your chosen time</li>
                        <li>• Share a tailored quotation and roadmap workshop proposal</li>
                      </ul>
                    </div>
                    <button
                      type="button"
                      onClick={() => {
                        setIsComplete(false);
                        setSubmitStatus({ type: '', message: '' });
                        setSaveStatus({ type: '', message: '' });
                        setCurrentPage(1);
                        setExistingResponseId(null);
                      }}
                      className="inline-flex items-center justify-center gap-2 px-6 py-3 border border-gray-300 rounded-lg text-gray-700 font-semibold transition hover:bg-gray-50"
                    >
                      <ChevronLeft className="w-5 h-5" />
                      Start over
                    </button>
                  </div>
                </div>
                <div className="text-center mt-8 text-gray-600 text-sm">
                  <p>© 2024 LCA-CALC. All rights reserved.</p>
                </div>
              </div>
            </div>
          );
        }

        return (
          <div className="min-h-screen py-12 px-4">
            <div className="max-w-4xl mx-auto">
              <div className="bg-white rounded-lg shadow-xl overflow-hidden">
                <div className="px-8 py-12 text-center gradient-header">
                  <div className="mx-auto mb-6 bg-white rounded-lg p-6 inline-block">
                    <img
                      src="https://dl.dropboxusercontent.com/scl/fi/b18q7sq7ei3z15luwple1/loogo.png?rlkey=ezqoudknshsl71pgpk07trso5&st=1p1mau1l&raw=1"
                      alt="LCA-CALC - Smart Eco-Lighting Metrics"
                      className="h-20 w-auto object-contain mx-auto"
                      onError={(event) => {
                        event.target.style.display = 'none';
                        event.target.parentElement.innerHTML = '<div style=\'color: #34EE63\' class=\'font-bold text-2xl\'>LCA-CALC</div>';
                      }}
                    />
                  </div>
                  <p className="text-xl text-white opacity-90">Solution tailored to your needs</p>
                </div>

                <div className="px-8 pt-6">
                  <div className="flex items-center justify-between mb-2">
                    <span className="text-sm font-medium text-gray-700">Step {currentPage} of {totalPages}</span>
                    <span className="text-sm font-medium text-gray-700">{Math.round(progressPercentage)}%</span>
                  </div>
                  <div className="w-full bg-gray-200 rounded-full h-3">
                    <div
                      className="h-3 rounded-full transition-all duration-300"
                      style={{ width: `${progressPercentage}%`, backgroundColor: '#34EE63' }}
                    />
                  </div>
                </div>

                <div className="p-8 space-y-8">
                  {/* Email input field - shown on all pages */}
                  <div className="space-y-3 pb-6 border-b-2 border-gray-200">
                    <label htmlFor="email" className="block text-lg font-semibold text-gray-900">
                      Your Email Address <span className="text-red-500">*</span>
                    </label>
                    <p className="text-sm text-gray-600">
                      Enter your email to save your progress and return to this form later.
                    </p>
                    <input
                      type="email"
                      id="email"
                      name="email"
                      value={formData.email}
                      onChange={handleChange}
                      className={inputClass}
                      placeholder="your.email@company.com"
                      required
                    />
                    {saveStatus.message && (
                      <div className={`rounded-lg p-3 flex items-start gap-3 ${
                        saveStatus.type === 'success'
                          ? 'bg-green-50 border border-green-200'
                          : 'bg-yellow-50 border border-yellow-200'
                      }`}>
                        {saveStatus.type === 'success' ? (
                          <CheckCircle2 className="w-5 h-5 text-green-600 flex-shrink-0 mt-0.5" />
                        ) : (
                          <AlertCircle className="w-5 h-5 text-yellow-600 flex-shrink-0 mt-0.5" />
                        )}
                        <p className={`text-sm ${
                          saveStatus.type === 'success' ? 'text-green-800' : 'text-yellow-800'
                        }`}>
                          {saveStatus.message}
                        </p>
                      </div>
                    )}
                  </div>

                  {currentPage === 1 && (
                    <div className="space-y-8">
                      <div className="space-y-3">
                        <label htmlFor="seats" className="block text-lg font-semibold text-gray-900">
                          Question 1: How many seats or users do you need?
                        </label>
                        <input
                          type="text"
                          id="seats"
                          name="seats"
                          value={formData.seats}
                          onChange={handleChange}
                          className={inputClass}
                          placeholder="Enter number of seats"
                        />
                      </div>

                      <div className="space-y-3">
                        <label htmlFor="lcasEpds" className="block text-lg font-semibold text-gray-900">
                          Question 2: Number of LCAs &amp; EPDs: how many do you require in the first year?
                        </label>
                        <input
                          type="text"
                          id="lcasEpds"
                          name="lcasEpds"
                          value={formData.lcasEpds}
                          onChange={handleChange}
                          className={inputClass}
                          placeholder="Enter number required"
                        />
                      </div>

                      <div className="space-y-3">
                        <label htmlFor="languages" className="block text-lg font-semibold text-gray-900">
                          Question 3: Do you need other languages than English?
                        </label>
                        <textarea
                          id="languages"
                          name="languages"
                          value={formData.languages}
                          onChange={handleChange}
                          rows="5"
                          className={inputClass}
                          placeholder="Please specify which languages you need..."
                        />
                      </div>
                    </div>
                  )}

                  {currentPage === 2 && (
                    <div className="space-y-8">
                      <div className="space-y-3">
                        <label htmlFor="materialsList" className="block text-lg font-semibold text-gray-900">
                          Question 4: Do you have a list of the most used materials for Flos Spain &amp; Italy?
                        </label>
                        <p className="text-sm text-gray-600">
                          If you don't have it, we can work on it together, the aim is to make sure that all the material datasets that you need are available.
                        </p>
                        <textarea
                          id="materialsList"
                          name="materialsList"
                          value={formData.materialsList}
                          onChange={handleChange}
                          rows="8"
                          className={inputClass}
                          placeholder="Please provide details about your materials list, or indicate if you need assistance creating one..."
                        />
                      </div>

                      <div className="space-y-3">
                        <label className="block text-lg font-semibold text-gray-900">
                          Question 5 – TM65 &amp; TM66: TM65 and TM66 interface
                        </label>
                        <p className="text-sm text-gray-600 mb-3">
                          Let's discuss over a call? Select your preferred time:
                        </p>
                        <div className="grid grid-cols-1 md:grid-cols-3 gap-3">
                          {[
                            'Monday 13/10/2025 from 10:30 to 13:30',
                            'Tuesday 14/10/2025 from 10:30 to 12:30',
                            'Wednesday 15/10/2025 from 11:30 to 13:30'
                          ].map((slot) => (
                            <button
                              key={slot}
                              type="button"
                              onClick={() =>
                                setFormData((prev) => ({
                                  ...prev,
                                  tm65CallTime: slot
                                }))
                              }
                              className={`p-4 rounded-lg border-2 transition-all text-left ${
                                formData.tm65CallTime === slot
                                  ? 'border-green-400 bg-green-50 shadow-md'
                                  : 'border-gray-300 hover:border-gray-400'
                              }`}
                            >
                              <div className="font-semibold text-gray-900">{slot.split(' from ')[0]}</div>
                              <div className="text-sm text-gray-600">{slot.split(' from ')[1]}</div>
                            </button>
                          ))}
                        </div>
                      </div>
                    </div>
                  )}

                  {currentPage === 3 && (
                    <div className="space-y-8">
                      <div className="space-y-6">
                        <div>
                          <label htmlFor="bomStorage" className="block text-lg font-semibold text-gray-900">
                            Question 6 – Data collection:
                          </label>
                          <label htmlFor="bomStorage" className="block text-base font-medium text-gray-900 mb-2">
                            Where is the information for the BOM for the luminaires stored?
                          </label>
                          <p className="text-sm text-gray-600 mb-2">
                            Please let us know if the information is stored in an API system, SAP, other software, or flat files—for example, your API or flat-file repositories.
                          </p>
                          <textarea
                            id="bomStorage"
                            name="bomStorage"
                            value={formData.bomStorage}
                            onChange={handleChange}
                            rows="6"
                            className={inputClass}
                            placeholder="Please describe in detail where your BOM information is stored..."
                          />
                        </div>

                        <div>
                          <label htmlFor="bomProcess" className="block text-base font-medium text-gray-900 mb-2">
                            What is the process to collect the information for the BOMs?
                          </label>
                          <textarea
                            id="bomProcess"
                            name="bomProcess"
                            value={formData.bomProcess}
                            onChange={handleChange}
                            rows="6"
                            className={inputClass}
                            placeholder="Please describe your BOM collection process in detail..."
                          />
                        </div>

                        <div>
                          <label htmlFor="skuProcess" className="block text-base font-medium text-gray-900 mb-2">
                            SKU creation process for variants
                          </label>
                          <p className="text-sm text-gray-600 mb-2">
                            Considering a luminaire and all its possible variants – like you did for the Workmate family – what is your process to create the SKUs for all possible variants?
                          </p>
                          <textarea
                            id="skuProcess"
                            name="skuProcess"
                            value={formData.skuProcess}
                            onChange={handleChange}
                            rows="6"
                            className={inputClass}
                            placeholder="Please describe your SKU creation process in detail..."
                          />
                        </div>
                      </div>
                    </div>
                  )}

                  {currentPage === 4 && (
                    <div className="space-y-8">
                      <div className="space-y-3">
                        <label htmlFor="sapSystem" className="block text-lg font-semibold text-gray-900">
                          Question 7 – API SAP system
                        </label>
                        <p className="text-base text-gray-700 mb-3">
                          Is the info for the BOMs available in your SAP system?
                        </p>
                        <textarea
                          id="sapSystem"
                          name="sapSystem"
                          value={formData.sapSystem}
                          onChange={handleChange}
                          rows="10"
                          className={inputClass}
                          placeholder="Please provide detailed information about your SAP system and BOM data availability..."
                        />
                      </div>
                    </div>
                  )}

                  {currentPage === 5 && (
                    <div className="space-y-8">
                      <div className="space-y-3">
                        <label className="block text-lg font-semibold text-gray-900">
                          Question 8 – LCA maturity:
                        </label>
                        <p className="text-base text-gray-700">
                          I propose to have a workshop so that we can discuss the roadmap from pilot to enterprise integration.
                        </p>
                        <div
                          className="rounded-lg p-4 text-sm"
                          style={{ backgroundColor: 'rgba(52, 238, 99, 0.1)', border: '1px solid rgba(52, 238, 99, 0.3)', color: '#1a5c2e' }}
                        >
                          We will schedule this workshop after reviewing your responses.
                        </div>
                      </div>

                      <div className="space-y-3">
                        <label htmlFor="trainingFunctions" className="block text-lg font-semibold text-gray-900">
                          Question 9 – Training:
                        </label>
                        <p className="text-base text-gray-700 mb-2">
                          I have planned training sessions for your R&amp;D team and for the sales team. Are there more functions that would benefit from a training session?
                        </p>
                        <textarea
                          id="trainingFunctions"
                          name="trainingFunctions"
                          value={formData.trainingFunctions}
                          onChange={handleChange}
                          rows="8"
                          className={inputClass}
                          placeholder="List any additional functions or departments that would benefit from training sessions..."
                        />
                      </div>

                      <div className="space-y-3">
                        <label htmlFor="additionalComments" className="block text-lg font-semibold text-gray-900">
                          Question 10 – Additional comments:
                        </label>
                        <p className="text-base text-gray-700 mb-2">
                          Any other comments or questions we can help you with?
                        </p>
                        <textarea
                          id="additionalComments"
                          name="additionalComments"
                          value={formData.additionalComments}
                          onChange={handleChange}
                          rows="6"
                          className={inputClass}
                          placeholder="Let us know how else we can support you..."
                        />
                      </div>
                    </div>
                  )}

                  {currentPage === 6 && (
                    <div className="space-y-8">
                      <div
                        className="rounded-lg p-6 space-y-4"
                        style={{ background: 'linear-gradient(to right, rgba(52, 238, 99, 0.08), rgba(99, 102, 241, 0.08))' }}
                      >
                        <h3 className="text-xl font-bold text-gray-900">Next Steps:</h3>
                        <div className="space-y-3">
                          <p className="text-base text-gray-700">After reviewing your responses, we will:</p>
                          <div className="text-base text-gray-700 space-y-2 pl-4">
                            <p>• Schedule the TM65 and TM66 interface discussion call at your selected time</p>
                            <p>• Share final quotation</p>
                            <p>• Schedule a workshop to discuss the integration roadmap from pilot to enterprise</p>
                          </div>
                        </div>
                      </div>

                      {submitStatus.type === 'error' && submitStatus.message && (
                        <div className="rounded-lg p-4 flex items-start gap-3 bg-red-50 border border-red-200">
                          <AlertCircle className="w-5 h-5 text-red-600 flex-shrink-0 mt-0.5" />
                          <p className="text-sm text-red-800">{submitStatus.message}</p>
                        </div>
                      )}
                    </div>
                  )}

                  {/* Save Progress Button */}
                  <div className="flex justify-center pt-6 border-t border-gray-200">
                    <button
                      onClick={handleSave}
                      disabled={isSaving || !formData.email}
                      className="flex items-center gap-2 px-6 py-3 rounded-lg border-2 transition disabled:opacity-50 disabled:cursor-not-allowed"
                      style={{
                        borderColor: '#34EE63',
                        color: '#2ACC56',
                        backgroundColor: 'rgba(52, 238, 99, 0.05)'
                      }}
                      onMouseEnter={(event) => {
                        if (!isSaving && formData.email) {
                          event.currentTarget.style.backgroundColor = 'rgba(52, 238, 99, 0.1)';
                        }
                      }}
                      onMouseLeave={(event) => {
                        event.currentTarget.style.backgroundColor = 'rgba(52, 238, 99, 0.05)';
                      }}
                    >
                      {isSaving ? (
                        <>
                          <Loader2 className="w-5 h-5 animate-spin" />
                          Saving...
                        </>
                      ) : (
                        <>
                          <Save className="w-5 h-5" />
                          Save Progress
                        </>
                      )}
                    </button>
                  </div>

                  <div className="flex justify-between items-center pt-6">
                    <button
                      onClick={prevPage}
                      disabled={currentPage === 1}
                      className="flex items-center gap-2 px-6 py-3 rounded-lg border-2 border-gray-300 text-gray-700 font-semibold transition disabled:opacity-50 disabled:cursor-not-allowed hover:border-gray-400 hover:bg-gray-50"
                    >
                      <ChevronLeft className="w-5 h-5" />
                      Previous
                    </button>

                    {currentPage < totalPages ? (
                      <button
                        onClick={nextPage}
                        className="flex items-center gap-2 text-white font-semibold px-6 py-3 rounded-lg transition shadow-lg hover:shadow-xl"
                        style={{ backgroundColor: '#34EE63' }}
                        onMouseEnter={(event) => {
                          event.currentTarget.style.backgroundColor = '#2ACC56';
                        }}
                        onMouseLeave={(event) => {
                          event.currentTarget.style.backgroundColor = '#34EE63';
                        }}
                      >
                        Next
                        <ChevronRight className="w-5 h-5" />
                      </button>
                    ) : (
                      <button
                        onClick={handleSubmit}
                        disabled={isSubmitting}
                        className="text-white font-semibold px-8 py-3 rounded-lg transition duration-200 flex items-center gap-2 disabled:opacity-50 disabled:cursor-not-allowed shadow-lg hover:shadow-xl"
                        style={{ backgroundColor: '#34EE63' }}
                        onMouseEnter={(event) => {
                          if (!isSubmitting) {
                            event.currentTarget.style.backgroundColor = '#2ACC56';
                          }
                        }}
                        onMouseLeave={(event) => {
                          if (!isSubmitting) {
                            event.currentTarget.style.backgroundColor = '#34EE63';
                          }
                        }}
                      >
                        {isSubmitting ? (
                          <>
                            <Loader2 className="w-5 h-5 animate-spin" />
                            Submitting...
                          </>
                        ) : (
                          'Submit Form'
                        )}
                      </button>
                    )}
                  </div>
                </div>
              </div>

              <div className="text-center mt-8 text-gray-600 text-sm">
                <p>© 2024 LCA-CALC. All rights reserved.</p>
              </div>
            </div>
          </div>
        );
      }

      const root = ReactDOM.createRoot(document.getElementById('root'));
      root.render(<LCACalcForm />);
    </script>
  </body>
</html>
